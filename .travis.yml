sudo: false
language: c
addons:
  apt:
    packages:
    - libgmp-dev
before_install:
- mkdir -p ~/.local/bin
- export PATH=$HOME/.local/bin:$PATH
- travis_retry curl -L https://www.stackage.org/stack/linux-x86_64 | tar xz --wildcards
  --strip-components=1 -C ~/.local/bin '*/stack'
script:
- stack --no-terminal --install-ghc build --fast --only-dependencies
- stack exec milkshake -- sitemap.yaml -c
cache:
  directories:
  - $HOME/.ghc
  - $HOME/.cabal
  - $HOME/.stack
deploy:
  provider: s3
  access_key_id: AKIAJA6NJX4EKRWECSHQ
  secret_access_key:
    secure: InKjQ0RtlWGF77h+Waxfat2gY+aRzEl/zSMIu89mAku6UFMZRZh28Nd84Vp2rfsz53y1lzQ7OfeNAAghaLRs1ArcA8i3haRq0Gmz9JFR8dUDgDwumFn9jPb7pZcQhgUtA3SPef4LncHOqPDRrEcN356a680cJH6UDGLc/OMxoxQ=
  bucket: ashley-allred.com
  local-dir: build/site
  acl: public_read
  region: us-west-1
  skip_cleanup: true
  on:
    repo: schell/ashley-allred
